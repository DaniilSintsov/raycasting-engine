!function(){var t={443:function(t){var e;t.exports=((e=function(){function t(t){return s.appendChild(t.dom),t}function n(t){for(var e=0;e<s.children.length;e++)s.children[e].style.display=e===t?"block":"none";o=t}var o=0,s=document.createElement("div");s.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",s.addEventListener("click",(function(t){t.preventDefault(),n(++o%s.children.length)}),!1);var i=(performance||Date).now(),r=i,l=0,a=t(new e.Panel("FPS","#0ff","#002")),c=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=t(new e.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:s,addPanel:t,showPanel:n,begin:function(){i=(performance||Date).now()},end:function(){l++;var t=(performance||Date).now();if(c.update(t-i,200),t>r+1e3&&(a.update(1e3*l/(t-r),100),r=t,l=0,h)){var e=performance.memory;h.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){i=this.end()},domElement:s,setMode:n}}).Panel=function(t,e,n){var o=1/0,s=0,i=Math.round,r=i(window.devicePixelRatio||1),l=80*r,a=48*r,c=3*r,h=2*r,f=3*r,d=15*r,u=74*r,p=30*r,g=document.createElement("canvas");g.width=l,g.height=a,g.style.cssText="width:80px;height:48px";var m=g.getContext("2d");return m.font="bold "+9*r+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=n,m.fillRect(0,0,l,a),m.fillStyle=e,m.fillText(t,c,h),m.fillRect(f,d,u,p),m.fillStyle=n,m.globalAlpha=.9,m.fillRect(f,d,u,p),{dom:g,update:function(a,y){o=Math.min(o,a),s=Math.max(s,a),m.fillStyle=n,m.globalAlpha=1,m.fillRect(0,0,l,d),m.fillStyle=e,m.fillText(i(a)+" "+t+" ("+i(o)+"-"+i(s)+")",c,h),m.drawImage(g,f+r,d,u-r,p,f,d,u-r,p),m.fillRect(f+u-r,d,r,p),m.fillStyle=n,m.globalAlpha=.9,m.fillRect(f+u-r,d,r,i((1-a/y)*p))}}},e)}},e={};function n(o){var s=e[o];if(void 0!==s)return s.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,n),i.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){"use strict";const t=!1,e=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,t,t,t,t,t,2,t,t,t,t,t,t,t,t,t,t,4,t,t,t,t,t,1],[1,t,2,2,t,t,t,t,t,2,2,2,t,t,t,3,t,t,t,t,4,t,t,1],[1,t,t,t,t,t,t,t,t,t,t,2,2,t,t,t,3,t,t,t,t,t,t,1],[1,t,2,2,t,t,t,t,t,t,t,t,2,t,4,t,t,3,t,t,t,4,t,1],[1,t,t,t,t,t,4,t,t,2,2,t,2,t,t,t,t,t,t,4,t,t,t,1],[1,t,3,t,t,t,2,t,t,2,t,t,2,t,t,t,4,t,t,t,t,4,t,1],[1,t,t,3,t,t,2,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,1],[1,t,3,t,t,t,t,t,t,t,3,t,t,3,3,t,t,t,t,3,3,t,t,1],[1,t,3,t,t,t,3,3,t,3,t,t,t,3,3,t,t,t,t,2,3,t,t,1],[1,t,t,t,t,3,t,3,t,t,3,t,t,t,t,t,t,t,t,t,t,t,t,1],[1,t,4,t,3,t,t,t,t,3,t,t,2,t,t,t,t,t,t,t,t,2,t,1],[1,t,t,t,t,t,4,t,t,t,t,t,2,2,t,t,t,t,t,t,2,2,t,1],[1,t,t,4,t,t,t,t,4,t,t,t,t,2,2,2,2,2,2,2,2,t,t,1],[1,t,t,t,t,t,t,t,t,t,4,t,t,t,t,t,t,t,t,t,t,t,t,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],o=window.innerWidth,s=window.innerHeight,i=5*s,r=2*s,l=(Math.floor(o/2),Math.floor(s/2)),a=100,c=e[0].length*a,h=e.length*a,f=Math.floor(12.5),d=[f*e[0].length,f*e.length],u=[0,s-d[1]],p=Math.PI/3,g=p/2,m=Math.floor(o/2),y=p/m,w=m/(2*Math.tan(g))*a,x=Math.floor(o/m),M=Math.floor(12),b=2*Math.PI,v=Math.floor(m/2)-1,A=m-1+200,S=new Map,E=new Set;function P(t){return Math.floor(180*t/Math.PI)}e.forEach(((t,e)=>{for(let n=0;n<t.length;n++)t[n]&&(E.add([n*a,e*a]),1===t[n]?S.set([n*a,e*a],"1"):2===t[n]?S.set([n*a,e*a],"2"):3===t[n]?S.set([n*a,e*a],"3"):4===t[n]&&S.set([n*a,e*a],"4"))}));class R{constructor(t,...e){this.context=t,this.textures={1:e[0],2:e[1],3:e[2],4:e[3],S:e[4]}}clear(){this.context.clearRect(0,0,o,s)}background(t){P(t),this.context.drawImage(this.textures.S,0,0,o,l),this.context.fillStyle="rgb(30, 30, 30)",this.context.fillRect(0,l,o,l)}world(t){(function(t,e={}){const n=void 0===e.key?t=>t:e.key,o=void 0!==e.reverse&&e.reverse,s=t.map(((t,e)=>[n(t),e])),i=Array.isArray(s[0][0])?(t,e)=>{for(let n=0;n<Math.min(t.length,e.length);n++){const o=t[n],s=e[n],i=o===s?0:o>s?1:-1;if(0!==i)return i}return t.length-e.length}:(t,e)=>{const n=t[0],o=e[0];return n===o?0:n>o?1:-1};return s.sort(i),o&&s.reverse(),s.map((e=>t[e[1]]))})(t,{key:t=>t[0],reverse:!0}).forEach((t=>{if(t[0]){const[e,n]=t;this.context.drawImage(...n)}}))}miniMap(t){const e=u[0]+Math.floor(t.posX/8),n=u[1]+Math.floor(t.posY/8);this.context.fillStyle="#000",this.context.fillRect(u[0],u[1],d[0],d[1]),this.context.strokeStyle="rgb(220, 220, 0)",this.context.beginPath(),this.context.moveTo(e,n),this.context.lineTo(e+11*Math.cos(t.getAngle),n+11*Math.sin(t.getAngle)),this.context.closePath(),this.context.stroke(),this.context.fillStyle="rgb(255, 140, 0)",this.context.beginPath(),this.context.arc(e,n,4,0,2*Math.PI),this.context.fill(),E.forEach((t=>{this.context.fillStyle="rgb(97, 61, 25)",this.context.fillRect(t[0]/a*f+u[0],t[1]/a*f+u[1],f,f)}))}}function k(t){return Math.floor(t/a)*a}class I{constructor(t,e,n,o,s,i){if(this.object=t,this.isStatic=e,this.posX=n*a,this.posY=o*a,this.shift=s,this.scale=i,!e){this.spriteAngles=[];for(let t=0;t<8;t++)this.spriteAngles[t]=[];for(let t=0;t<360;t+=45)for(let e=t;e<t+45;e++)this.spriteAngles[t/45].push(e);this.spritePositions=new Map,this.spriteAngles.forEach(((t,e)=>{this.spritePositions.set(t,this.object[e])}))}}objectLocate(t){const e=this.posX-t.posX,n=this.posY-t.posY;let o=Math.sqrt(e**2+n**2),s=Math.atan2(n,e),i=s-t.getAngle;(e>0&&180<=P(t.getAngle)&&P(t.getAngle)<=360||e<0&&n<0)&&(i+=b);const a=Math.floor(i/y),c=v+a;o*=Math.cos(g-c*y);const h=c+100;if(0<=h&&h<=A&&o>30){const t=Math.min(Math.floor(w/o*this.scale),r),e=Math.floor(t/2),n=e*this.shift;if(!this.isStatic){s<0&&(s+=b),s=360-P(s);for(let t of this.spriteAngles)if(t.includes(s)){this.object=this.spritePositions.get(this.spriteAngles[t[0]/45]);break}}return[o,[this.object,c*x-e,l-e+n,t,t]]}return!1}}const j=document.getElementById("wall1"),T=document.getElementById("wall2"),L=document.getElementById("wall3"),B=document.getElementById("wall4"),K=document.getElementById("sky"),O=document.getElementById("barrel"),X=document.getElementById("pedestal"),Y=[];for(let t=0;t<8;t++)Y.push(document.getElementById(`cacodemon${t}`));const D=new class{constructor(){this.x=150,this.y=350,this.angle=0}get posX(){return this.x}get posY(){return this.y}get getAngle(){return this.angle}movement(t){const e=Math.sin(this.angle),n=Math.cos(this.angle);t.up&&(this.x+=2*n,this.y+=2*e),t.down&&(this.x+=-2*n,this.y+=-2*e),t.left&&(this.x+=2*e,this.y+=-2*n),t.right&&(this.x+=-2*e,this.y+=2*n),t.turnLeft&&(this.angle-=.01),t.turnRight&&(this.angle+=.01),this.angle=this.angle%b<0?b+this.angle%b:this.angle%b}},H=new class{constructor(...t){this.spriteTypes={barrel:t[0],pedestal:t[1],cacodemon:t[2]},this.listOfObjects=[new I(this.spriteTypes.barrel,!0,7.1,2.1,1.8,.4),new I(this.spriteTypes.barrel,!0,5.9,2.1,1.8,.4),new I(this.spriteTypes.pedestal,!0,8.8,2.5,1.6,.5),new I(this.spriteTypes.pedestal,!0,8.8,5.6,1.6,.5),new I(this.spriteTypes.cacodemon,!1,7,4,-1.5,.7)]}}(O,X,Y);var z=n(443),C=n.n(z);const W=document.createElement("canvas");W.setAttribute("width",o),W.setAttribute("height",s);const q=new(C());q.showPanel(0),document.body.insertAdjacentElement("afterbegin",W),document.body.insertAdjacentElement("afterbegin",q.dom);const F=W.getContext("2d"),_={up:!1,down:!1,left:!1,right:!1,turnLeft:!1,turnRight:!1};let J=0,N=performance.now();const V=1/60;function $(){let t=performance.now();for(J+=(t-N)/1e3;J>V;)J-=V;N=t,q.begin(),function(t,e){const n=new R(t,j,T,L,B,K);D.movement(e),n.clear(),n.background(D.getAngle);const o=function(t,e){const n=[],o=k(t.posX),s=k(t.posY);let r=1,f=1,d=t.getAngle-g;for(let u=0;u<m;u++){const p=Math.sin(d),g=Math.cos(d);let m,b,v,A,E=!1,P=!1,R=g>=0?o+a:o,I=g>=0?1:-1;for(let e=0;e<c;e+=a){m=(R-t.posX)/g,v=t.posY+m*p;for(let t of S.keys())t[0]===k(R+I)&&t[1]===k(v)&&(r=S.get(t),E=!0);if(E)break;R+=I*a}let j=p>=0?s+a:s,T=p>=0?1:-1;for(let e=0;e<h;e+=a){b=(j-t.posY)/p,A=t.posX+b*g;for(let t of S.keys())t[0]===k(A)&&t[1]===k(j+T)&&(f=S.get(t),P=!0);if(P)break;j+=T*a}let L=m<b?m:b,B=m<b?v:A;const K=m<b?r:f;B=Math.floor(B)%a,L*=Math.cos(t.getAngle-d),L=Math.max(L,1e-5);const O=Math.min(Math.floor(w/L),i),X=[e[K],B*M,0,M,1200,u*x,l-Math.floor(O/2),x,O];n.push([L,X]),d+=y}return n}(D,n.textures),s=[];H.listOfObjects.forEach((t=>{s.push(t.objectLocate(D))})),n.world([...o,...s]),n.miniMap(D)}(F,_),q.end(),requestAnimationFrame($)}window.addEventListener("load",(function(){$()})),document.onkeydown=function(t){"KeyW"===t.code&&(_.up=!0),"KeyS"===t.code&&(_.down=!0),"KeyA"===t.code&&(_.left=!0),"KeyD"===t.code&&(_.right=!0),"ArrowLeft"===t.code&&(_.turnLeft=!0),"ArrowRight"===t.code&&(_.turnRight=!0)},document.onkeyup=function(t){"KeyW"===t.code&&(_.up=!1),"KeyS"===t.code&&(_.down=!1),"KeyA"===t.code&&(_.left=!1),"KeyD"===t.code&&(_.right=!1),"ArrowLeft"===t.code&&(_.turnLeft=!1),"ArrowRight"===t.code&&(_.turnRight=!1)}}()}();